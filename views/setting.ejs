<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Expense Splitter</title>
  <link rel="stylesheet" href="/styles/style.css">
  <!-- Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
  crossorigin="anonymous"
/>

<!-- Bootstrap Icons (since you use bi bi-person-circle etc.) -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
/>

  <style>
:root {
  --primary: rgb(244, 62, 92);
  --primary-hover: rgb(244, 62, 92);
  --bg-light: #fff5f8;
  --bg-card: #ffffff;
  --border: #f0d6de;
  --text: #2b2b2b;
  --muted: #757575;
  --radius: 14px;
  --shadow: 0 6px 18px rgba(0, 0, 0, 0.07);
  --transition: all 0.3s ease;
  --sidebar-width: 260px;
  --font: 'Poppins', sans-serif;
}

/* --- BASE PAGE --- */
body {
  font-family: var(--font);
  background: var(--bg-light);
  margin: 0;
  color: var(--text);
}

/* --- WRAPPER --- */
.settings-wrapper {
  display: flex;
  min-height: 100vh;
  overflow: hidden;
}

/* --- SIDEBAR --- */
.settings-sidebar {
  margin-top: 70px;
  width: var(--sidebar-width);
  background: linear-gradient(180deg, #ffeef5, #fff);
  border-right: 1px solid var(--border);
  box-shadow: 4px 0 10px rgba(233, 30, 99, 0.08);
  display: flex;
  flex-direction: column;
  align-items: stretch;
  padding: 25px 20px;
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  overflow-y: auto;
}

.settings-sidebar h3 {
  text-align: center;
  font-family: 'Pacifico', cursive;
  color: var(--primary);
  margin-bottom: 30px;
  font-size: 1.8rem;
}

.settings-sidebar ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.settings-sidebar button {
  width: 100%;
  background: #fff;
  border: 1px solid var(--border);
  text-align: left;
  padding: 14px 18px;
  border-radius: var(--radius);
  font-size: 1rem;
  color: var(--primary);
  font-weight: 500;
  margin-bottom: 10px;
  transition: var(--transition);
  cursor: pointer;
}

.settings-sidebar button:hover,
.settings-sidebar button.active {
  background: linear-gradient(90deg, var(--primary), var(--primary-hover));
  color: #fff;
  box-shadow: 0 3px 10px rgba(233, 30, 99, 0.25);
  transform: translateX(5px);
}

/* --- MAIN AREA --- */
.settings-main {
  flex-grow: 1;
  margin-left: var(--sidebar-width);
  padding: 60px 80px;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  background: var(--bg-light);
}

.settings-container {
  background: var(--bg-card);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 50px;
  width: 100%;
  max-width: 950px;
  animation: fadeIn 0.5s ease;
}

/* --- SECTION --- */
.setting-section {
  display: none;
  animation: fadeIn 0.6s ease;
}

.setting-section.active {
  display: block;
}

.setting-section h2,
.setting-section h3 {
  color: var(--primary);
  font-weight: 700;
  margin-bottom: 25px;
  text-align: center;
}

/* --- FORM ELEMENTS --- */
.settings-container input,
.settings-container textarea {
  width: 100%;
  margin-bottom: 18px;
  padding: 12px 16px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  transition: var(--transition);
  font-size: 1rem;
  background: #fff;
  color: var(--text);
}

.settings-container input:focus,
.settings-container textarea:focus {
  border-color: var(--primary);
  box-shadow: 0 0 8px rgba(233, 30, 99, 0.2);
  outline: none;
}

/* --- PASSWORD FIELD --- */
.password-group {
  position: relative;
}

.toggle-btn {
  position: absolute;
  right: 15px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--primary);
  font-weight: 600;
  cursor: pointer;
  transition: color 0.2s ease;
}

.toggle-btn:hover {
  color: var(--primary-hover);
}

.strength-text {
  font-size: 0.9rem;
  margin-top: -6px;
  margin-bottom: 10px;
  color: var(--muted);
  font-weight: 500;
}

/* --- FAQ --- */
.faq-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.faq-item {
  background: #fff;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
  padding: 18px 20px;
  transition: var(--transition);
  cursor: pointer;
}

.faq-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
}

.faq-question {
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: var(--primary);
  font-weight: 600;
  font-size: 1.05rem;
}

.faq-answer {
  max-height: 0;
  overflow: hidden;
  color: var(--text);
  line-height: 1.6;
  transition: max-height 0.4s ease, padding 0.3s ease;
}

.faq-item.active .faq-answer {
  max-height: 200px;
  padding-top: 8px;
}

/* --- BUTTONS --- */
.btn-gradient {
  background: linear-gradient(90deg, var(--primary), var(--primary-hover));
  border: none;
  color: #fff;
  border-radius: var(--radius);
  padding: 12px 15px;
  font-weight: 600;
  width: 100%;
  transition: var(--transition);
}

.btn-gradient:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(233, 30, 99, 0.25);
}

/* --- TOAST --- */
.toast {
  position: fixed;
  bottom: 30px;
  right: 30px;
  background: #fff;
  padding: 16px 22px;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  opacity: 0;
  transform: translateY(20px);
  transition: var(--transition);
  font-weight: 500;
  z-index: 9999;
}
.toast.show {
  opacity: 1;
  transform: translateY(0);
}
.toast.success {
  border-left: 6px solid #4caf50;
  color: #2e7d32;
}
.toast.error {
  border-left: 6px solid #f44336;
  color: #b71c1c;
}

/* --- NAVBAR --- */
nav {
  background: linear-gradient(90deg, var(--primary), var(--primary-hover));
  box-shadow: 0 3px 10px rgba(248, 6, 119, 0.2);
}

nav a.nav-links {
  color: #fff !important;
  font-weight: 600;
  padding: 8px 14px;
  margin-left: 10px;
  border-radius: 10px;
  text-decoration: none;
  transition: background-color 0.3s ease;
}

nav a.nav-links:hover {
  background-color: rgba(255, 255, 255, 0.2);
}

.navbar-brand, h4.fw-bold {
  color: #fff !important;
}

/* Profile Dropdown */
.profile-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid #fff;
  cursor: pointer;
  transition: transform 0.2s ease;
}
.profile-avatar:hover {
  transform: scale(1.05);
}
.dropdown-content {
  display: none;
  position: absolute;
  right: 0;
  background-color: #fff;
  min-width: 160px;
  box-shadow: 0 8px 16px rgba(0,0,0,0.2);
  border-radius: 10px;
  z-index: 1;
  overflow: hidden;
}
.dropdown-content a, .dropdown-content button {
  color: #333;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  width: 100%;
  text-align: left;
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1rem;
  transition: background-color 0.2s ease;
}
.dropdown-content a:hover, .dropdown-content button:hover {
  background-color: #f1f1f1;
}
.dropdown.show .dropdown-content {
  display: block;
}

/* --- RESPONSIVE --- */
@media (max-width: 992px) {
  .settings-wrapper {
    flex-direction: column;
  }
  .settings-sidebar {
    width: 100%;
    flex-direction: row;
    justify-content: space-evenly;
    border-bottom: 1px solid var(--border);
    border-right: none;
    margin-top: 0;
    position: relative;
  }
  .settings-sidebar h3 {
    display: none;
  }
  .settings-main {
    margin-left: 0;
    padding: 40px 25px;
  }
  .settings-container {
    padding: 35px 25px;
  }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
 </style>
</head>

<body>
  <!-- Include Navbar -->
  <nav class="navbar navbar-expand-lg py-3">
  <div class="container">
    <h4 class="fw-bold">Smart Expense Splitter</h4>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto align-items-center">
        <% if (!user) { %>
          <li class="nav-item"><a class="nav-link" href="/register">Sign Up</a></li>
          <li class="nav-item"><a class="nav-link" href="/login">Login</a></li>
        <% } else { %>
          <li class="nav-item"><a class="nav-links active" href="/home">Home</a></li>
          <li class="nav-item"><a class="nav-links" href="/groups">Groups</a></li>
          <li class="nav-item"><a class="nav-links" href="/expenses">Expenses</a></li>
          <li class="nav-item"><a class="nav-links" href="/about">About</a></li>

          <!-- Profile Dropdown -->
          <li class="nav-item dropdown ms-3">
            <div class="dropdown">
              <div class="profile-trigger" onclick="toggleDropdown()">
                <img
                  src="<%= user.profilePic
                    ? '/uploads/' + user.profilePic
                    : 'https://i.pinimg.com/1200x/8b/84/17/8b841799752db5b6e1aa1aa56fe737db.jpg' %>"
                  alt="Profile"
                  class="profile-avatar"
                />
              </div>

              <div id="profileDropdown" class="dropdown-content shadow-lg">
                <a href="/profile"><i class="bi bi-person-circle"></i> Profile</a>
                <a href="/setting"><i class="bi bi-gear"></i> Settings</a>
                <form id="logoutForm" action="/logout" method="POST" style="display:inline;">
                  <button type="button" class="dropdown-logout" data-bs-toggle="modal" data-bs-target="#logoutModal">
                    <i class="bi bi-box-arrow-right"></i> Logout
                  </button>
                </form>
              </div>
            </div>
          </li>
        <% } %>
      </ul>
    </div>
  </div>
</nav>
  <!-- Settings Wrapper -->
  <div class="settings-wrapper">
    <!-- Sidebar -->
    <aside class="settings-sidebar">
      <h3>Settings ‚öôÔ∏è</h3>
      <ul>
        <li><button class="active" onclick="showSection('password')">Change Password</button></li>
        <li><button onclick="showSection('faq')">FAQs</button></li>
        <li><button onclick="showSection('contact')">Contact</button></li>
      </ul>
    </aside>

    <!-- Main -->
    <main class="settings-main">
      <div class="settings-container">

        <!-- Change Password -->
        <section id="password" class="setting-section active">
          <h3>Change Password üîí</h3>
          <form id="passwordForm" style="max-width: 450px; margin:auto;">
            <label>Current Password</label>
            <div class="password-group">
              <input type="password" id="currentPassword" required />
              <button type="button" class="toggle-btn" onclick="togglePassword('currentPassword', this)">Show</button>
            </div>

            <label>New Password</label>
            <div class="password-group">
              <input type="password" id="newPassword" required oninput="checkStrength()" />
              <button type="button" class="toggle-btn" onclick="togglePassword('newPassword', this)">Show</button>
            </div>
            <div id="passwordStrength" class="strength-text"></div>

            <label>Confirm New Password</label>
            <div class="password-group">
              <input type="password" id="confirmPassword" required />
              <button type="button" class="toggle-btn" onclick="togglePassword('confirmPassword', this)">Show</button>
            </div>
            <div id="passwordMatchMsg" class="strength-text"></div>

            <button type="submit" class="btn-gradient mt-3">Update Password</button>
          </form>
        </section>

        <!-- FAQ Section -->
        <section id="faq" class="setting-section">
          <h2>FAQs ‚ùì</h2>
          <div class="faq-container">
            <div class="faq-item">
              <div class="faq-question">üí∞ How does splitting work?<span>‚ñº</span></div>
              <div class="faq-answer">The app calculates each person's share fairly and transparently based on total expenses.</div>
            </div>
            <div class="faq-item">
              <div class="faq-question">üì± Can I use this on mobile?<span>‚ñº</span></div>
              <div class="faq-answer">Yes! The app is fully responsive across all devices.</div>
            </div>
            <div class="faq-item">
              <div class="faq-question">üîê Is my data safe?<span>‚ñº</span></div>
              <div class="faq-answer">Absolutely! Data is encrypted and never shared externally.</div>
            </div>
            <div class="faq-item">
              <div class="faq-question">üë• Can I invite friends?<span>‚ñº</span></div>
              <div class="faq-answer">Yes! Create groups and invite friends by email to manage shared expenses.</div>
            </div>
          </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="setting-section">
          <h2>Contact Us üì¨</h2>
          <p style="text-align:center;color:var(--muted);margin-bottom:20px;">We‚Äôd love to hear your feedback!</p>
          <form id="contactForm" style="max-width:500px;margin:auto;">
            <input type="text" id="name" placeholder="Your Name" required />
            <input type="email" id="email" placeholder="Your Email" required />
            <textarea id="message" rows="4" placeholder="Type your message..." required></textarea>
            <button type="submit" class="btn-gradient mt-3">Send Message üíå</button>
          </form>
        </section>
      </div>
    </main>
  </div>

  <script>
function showSection(id){
  document.querySelectorAll('.setting-section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.settings-sidebar button').forEach(b=>b.classList.remove('active'));
  event.target.classList.add('active');
}
function togglePassword(id,btn){
  const f=document.getElementById(id);
  f.type=f.type==="password"?"text":"password";
  btn.textContent=f.type==="password"?"Show":"Hide";
}
function checkStrength(){
  const p=document.getElementById("newPassword").value;
  const t=document.getElementById("passwordStrength");
  let s=0;
  if(p.length>=8)s++;
  if(/[A-Z]/.test(p))s++;
  if(/[0-9]/.test(p))s++;
  if(/[^A-Za-z0-9]/.test(p))s++;
  const msg=["Weak üíî","Medium üíõ","Strong üí™","Very Strong üî•"];
  const col=["#ff6f91","#ffb347","#6fd37f","#2ecc71"];
  t.textContent=msg[s-1]||"";
  t.style.color=col[s-1]||"";
}
document.getElementById("confirmPassword").addEventListener("input",function(){
  const newP=document.getElementById("newPassword").value;
  const msg=document.getElementById("passwordMatchMsg");
  msg.textContent=this.value===newP?"‚úÖ Passwords match":"‚ùå Passwords do not match";
  msg.style.color=this.value===newP?"#6fd37f":"#ff6f91";
});
document.querySelectorAll('.faq-item').forEach(f=>f.addEventListener('click',()=>f.classList.toggle('active')));
  </script>
</body>
</html>